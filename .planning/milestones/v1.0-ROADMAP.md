# Milestone v1.0: Portfolio Cleanup

**Status:** SHIPPED 2026-02-05
**Phases:** 1-5
**Total Plans:** 6

## Overview

This cleanup milestone systematically addresses technical debt in the portfolio's interactive graph visualization. Starting with safe dead code removal, we extract hardcoded values to constants, strengthen type safety, refactor state management, and optimize performance. Each phase preserves the existing user experience while improving code maintainability.

## Phases

### Phase 1: Dead Code Removal

**Goal**: Codebase contains only features that are actively used, with no dead imports or unused variables
**Depends on**: Nothing (first phase)
**Requirements**: DEAD-01, DEAD-02, DEAD-03
**Plans**: 1 plan

Plans:

- [x] 01-01-PLAN.md — Remove unused graph store features and clean up component props

**Outcome**: Graph store reduced from 98 to 31 lines, removed unused filter/highlight/view mode features

### Phase 2: Constants Extraction

**Goal**: All magic numbers are replaced with named constants in a centralized location
**Depends on**: Phase 1
**Requirements**: CONST-01, CONST-02, CONST-03, CONST-04
**Plans**: 1 plan

Plans:

- [x] 02-01-PLAN.md — Extract layout, positioning, and timing constants to centralized file

**Outcome**: Created lib/layout-constants.ts with domain-grouped constants (SAFE_AREA, ACHIEVEMENT_LAYOUT, REVEAL_TIMING)

### Phase 3: Type Safety

**Goal**: TypeScript type checking catches all data shape errors without implicit any
**Depends on**: Phase 2
**Requirements**: TYPE-01, TYPE-02, TYPE-03
**Plans**: 1 plan

Plans:

- [x] 03-01-PLAN.md — Create discriminated union types and fix store serialization

**Outcome**: Discriminated union GraphNode type with 5 variants, shared AchievementNodeDisplayData type, JSON-serializable store

### Phase 4: State Management Refactor

**Goal**: Component state is managed through clear patterns without ref coordination issues
**Depends on**: Phase 3
**Requirements**: STATE-01, STATE-02, STATE-03
**Plans**: 1 plan

Plans:

- [x] 04-01-PLAN.md — Move reveal state to store and eliminate stale closure workaround

**Outcome**: Reveal state moved to Zustand store, refs reduced from 6 to 3, eliminated stale closure workaround

### Phase 5: Performance Optimization

**Goal**: Animation and layout performance is optimized without perceptible lag
**Depends on**: Phase 4
**Requirements**: PERF-01, PERF-02, PERF-03, PERF-04
**Plans**: 2 plans

Plans:

- [x] 05-01-PLAN.md — Extract animation variants to module-level constants and add memoization
- [x] 05-02-PLAN.md — Batch fitView calls with debouncing and optimize reveal sequence

**Outcome**: Module-level animation variants, memoized position calculations, debounced fitView (7+ calls reduced to 1-2)

---

## Milestone Summary

**Key Decisions:**

| Decision                           | Rationale                                       | Outcome |
| ---------------------------------- | ----------------------------------------------- | ------- |
| Retain underscore-prefixed id prop | ReactFlow interface requires it                 | Good    |
| Replace Set with array in store    | JSON serializability for <50 nodes              | Good    |
| Use store.getState() for callbacks | Avoids stale closures without ref workarounds   | Good    |
| Destructure dimensions for useMemo | React Compiler requires primitive dependencies  | Good    |
| Use useMemo for debounced fitView  | React Compiler forbids ref access during render | Good    |

**Issues Resolved:**

- Unused graph store features increasing bundle size
- Magic numbers scattered across layout code
- Implicit any types in layout calculator
- Stale closure risks in hover handlers
- Excessive fitView calls during reveal (7+ reduced to 1-2)

**Technical Debt Incurred:**

- None significant — cleanup milestone paid down debt

---

_Archived: 2026-02-05_
_For current project status, see .planning/ROADMAP.md (next milestone)_
