---
phase: 12-ppr-image-optimization
plan: 02
type: execute
wave: 1
depends_on: []
files_modified:
  - components/sections/tech-and-code-section.tsx
  - next.config.ts
autonomous: false

must_haves:
  truths:
    - "Tech stack icons use next/image with explicit width/height and produce no layout shift on load"
    - "SVG icons render identically to before (same size, same position, no visual regression)"
  artifacts:
    - path: "components/sections/tech-and-code-section.tsx"
      provides: "next/image for all tech stack icons with explicit width/height"
      contains: "import Image from"
    - path: "next.config.ts"
      provides: "dangerouslyAllowSVG enabled for SVG image handling"
  key_links:
    - from: "components/sections/tech-and-code-section.tsx"
      to: "next/image"
      via: "Image component with width, height, unoptimized props"
      pattern: "<Image.*src=.tech\\.icon.*width="
---

<objective>
Replace raw `<img>` tags with `next/image` for tech stack icons to prevent layout shift and follow Next.js best practices.

Purpose: The tech stack section uses 27 SVG icons via raw `<img>` tags (with an eslint-disable comment). Replacing them with `next/image` adds explicit dimensions that prevent layout shift, removes the eslint suppression, and completes the IMG-01/IMG-02 requirements.

Output: All tech stack icons render via `next/image` with explicit width/height. No layout shift. Visual appearance unchanged.
</objective>

<execution_context>
@/Users/sunny/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sunny/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md

@components/sections/tech-and-code-section.tsx
@data/tech-stack.ts
@next.config.ts
</context>

<tasks>

<task type="auto">
  <name>Task 1: Replace img with next/image for tech stack icons</name>
  <files>
    components/sections/tech-and-code-section.tsx
    next.config.ts
  </files>
  <action>
    1. **In next.config.ts**, add SVG support to images config:
       ```ts
       images: {
         formats: ["image/avif", "image/webp"],
         dangerouslyAllowSVG: true,
         contentDispositionType: "attachment",
         contentSecurityPolicy: "default-src 'self'; script-src 'none'; sandbox;",
       },
       ```
       This is needed because next/image doesn't optimize SVGs by default. The security policy prevents any script execution within SVGs.

    2. **In tech-and-code-section.tsx:**
       - Add import: `import Image from "next/image"`
       - Replace the raw `<img>` element:
         ```tsx
         {/* eslint-disable-next-line @next/next/no-img-element */}
         <img
           src={tech.icon}
           alt={tech.name}
           className="w-6 h-6 md:w-7 md:h-7 object-contain"
         />
         ```
         With next/image:
         ```tsx
         <Image
           src={tech.icon}
           alt={tech.name}
           width={28}
           height={28}
           className="w-6 h-6 md:w-7 md:h-7 object-contain"
           unoptimized
         />
         ```
       - Use `width={28}` and `height={28}` (matches the md:w-7 = 28px intrinsic size; CSS classes handle responsive sizing)
       - Add `unoptimized` prop since SVGs are already vector format and don't need the image optimization pipeline (this also avoids unnecessary server processing)
       - Remove the `{/* eslint-disable-next-line @next/next/no-img-element */}` comment (no longer needed)

    **Why unoptimized:** SVGs are already resolution-independent vectors. Running them through Next.js image optimization would either rasterize them (losing quality) or add unnecessary overhead. The `unoptimized` prop keeps them as-is while still getting the layout shift prevention from explicit dimensions.

    **Why width=28/height=28:** The CSS classes `w-6 h-6 md:w-7 md:h-7` handle actual rendered size (24px mobile, 28px desktop). The intrinsic width/height should match the largest rendered size to prevent any scaling artifacts. 28px matches md:w-7.

  </action>
  <verify>
    Run `npm run build` -- build succeeds with zero errors. Grep for `no-img-element` in tech-and-code-section.tsx -- should find zero matches. Grep for `import Image from` -- should find a match.
  </verify>
  <done>
    All 27 tech stack icons render via next/image with width={28} height={28}. No eslint suppress comment. No layout shift.
  </done>
</task>

<task type="checkpoint:human-verify" gate="blocking">
  <what-built>
    Replaced all raw img tags with next/image for tech stack icons. SVGs render with explicit dimensions to prevent layout shift.
  </what-built>
  <how-to-verify>
    1. Run `npm run dev` and open http://localhost:3000
    2. Scroll to the "STACK & CODE" section
    3. Verify all 27 tech icons render correctly (same size, same position as before)
    4. Check no layout shift occurs when icons load (they should be visible immediately)
    5. Open DevTools > Elements and inspect an icon -- confirm it uses an `<img>` tag from next/image (with srcset or direct src) and has width/height attributes
  </how-to-verify>
  <resume-signal>Type "approved" if icons look correct, or describe any visual issues</resume-signal>
</task>

</tasks>

<verification>
1. `npm run build` passes with zero errors
2. Grep: No `eslint-disable.*no-img-element` in tech-and-code-section.tsx
3. Grep: `import Image from "next/image"` exists in tech-and-code-section.tsx
4. Grep: `width={28}` and `height={28}` present on Image components
5. Visual: Icons render at correct size with no layout shift
</verification>

<success_criteria>

- All tech stack icons use next/image with explicit width={28} height={28}
- The eslint-disable comment for no-img-element is removed
- SVGs render identically to before (no visual regression)
- No layout shift when icons load
- Build passes cleanly
  </success_criteria>

<output>
After completion, create `.planning/phases/12-ppr-image-optimization/12-02-SUMMARY.md`
</output>
