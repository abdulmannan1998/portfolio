---
phase: 10-client-boundary-extraction
plan: 03
type: execute
wave: 1
depends_on: []
files_modified:
  - app/loading.tsx
  - components/css-preloader.tsx
  - components/graph-legend.tsx
  - components/marquee-text.tsx
  - app/globals.css
autonomous: true
gap_closure: true

must_haves:
  truths:
    - "app/loading.tsx does not exist (deleted)"
    - "components/css-preloader.tsx does not exist (deleted)"
    - "components/graph-legend.tsx does not exist (deleted)"
    - "MarqueeText scrolls continuously using framer-motion with 'use client' directive"
    - "No orphaned @keyframes remain in globals.css (preloader-*, legend-slide-in, marquee-scroll all removed)"
  artifacts:
    - path: "components/marquee-text.tsx"
      provides: "Framer-motion marquee animation"
      contains: "use client"
    - path: "app/globals.css"
      provides: "Only twinkle @keyframes remains"
  key_links:
    - from: "components/marquee-text.tsx"
      to: "framer-motion"
      via: "import { motion }"
      pattern: "motion\\.div"
    - from: "components/marquee-text.tsx"
      to: "components/page-content.tsx"
      via: "import"
      pattern: "MarqueeText"
---

<objective>
Close 3 UAT gaps from Phase 10 verification: remove obsolete CSSPreloader/loading.tsx (dead code after ISR), delete unused GraphLegend, and revert MarqueeText to framer-motion per strategy pivot. Clean up orphaned @keyframes from globals.css.

Purpose: Eliminate dead code that ISR made obsolete, honor the project decision to keep framer-motion for animations, and leave no orphaned CSS artifacts.
Output: 3 files deleted, 2 files modified (marquee-text.tsx reverted, globals.css cleaned).
</objective>

<execution_context>
@/Users/sunny/.claude/get-shit-done/workflows/execute-plan.md
@/Users/sunny/.claude/get-shit-done/templates/summary.md
</execution_context>

<context>
@.planning/PROJECT.md
@.planning/ROADMAP.md
@.planning/STATE.md
@.planning/phases/10-client-boundary-extraction/10-UAT.md
</context>

<tasks>

<task type="auto">
  <name>Task 1: Delete obsolete preloader and graph-legend files</name>
  <files>
    app/loading.tsx
    components/css-preloader.tsx
    components/graph-legend.tsx
    app/globals.css
  </files>
  <action>
    1. Delete `app/loading.tsx` -- ISR pre-renders full HTML, making Next.js loading UI obsolete. The CSSPreloader never triggers because the server sends complete HTML.

    2. Delete `components/css-preloader.tsx` -- Only consumer was loading.tsx (just deleted). Zero other imports exist.

    3. Delete `components/graph-legend.tsx` -- Zero imports anywhere in codebase. Pure dead code that was mistakenly converted to a server component.

    4. Edit `app/globals.css` to remove ALL of the following @keyframes blocks:
       - Lines 128-176: The entire "Preloader animations" section (preloader-fade-in, preloader-step-fade, preloader-progress, preloader-welcome-fade, preloader-blink)
       - Lines 189-199: @keyframes legend-slide-in (the "Graph legend entrance animation" section)
       - Lines 201-209: @keyframes marquee-scroll (the "Marquee text animation" section)

    Keep ONLY the "Twinkling stars animation" @keyframes twinkle block (currently lines 178-187).

    After editing, globals.css should end with the @keyframes twinkle block followed by a single trailing newline.

  </action>
  <verify>
    - `ls app/loading.tsx` returns "No such file"
    - `ls components/css-preloader.tsx` returns "No such file"
    - `ls components/graph-legend.tsx` returns "No such file"
    - `grep -c "@keyframes" app/globals.css` returns exactly 1 (only twinkle remains)
    - `grep "preloader\|legend-slide-in\|marquee-scroll" app/globals.css` returns no matches
    - `grep "@keyframes twinkle" app/globals.css` returns a match
  </verify>
  <done>Three dead files deleted. globals.css contains only the twinkle @keyframes -- all preloader, legend, and marquee CSS animations removed.</done>
</task>

<task type="auto">
  <name>Task 2: Revert MarqueeText to framer-motion</name>
  <files>components/marquee-text.tsx</files>
  <action>
    Replace the entire contents of `components/marquee-text.tsx` with the original framer-motion implementation:

    ```tsx
    "use client";

    import { motion } from "framer-motion";

    export type MarqueeTextProps = {
      text: string;
      direction?: number;
    };

    export function MarqueeText({ text, direction = 1 }: MarqueeTextProps) {
      return (
        <div className="overflow-hidden whitespace-nowrap">
          <motion.div
            animate={{ x: direction > 0 ? ["0%", "-50%"] : ["-50%", "0%"] }}
            transition={{ duration: 20, repeat: Infinity, ease: "linear" }}
            className="inline-flex"
          >
            {[...Array(4)].map((_, i) => (
              <span key={i} className="mx-4">
                {text}
              </span>
            ))}
          </motion.div>
        </div>
      );
    }
    ```

    Key changes from current version:
    - Add `"use client"` directive at top (required for framer-motion)
    - Add `import { motion } from "framer-motion"`
    - Replace plain `<div>` with `<motion.div>` using `animate` and `transition` props
    - Remove inline `style={{ animation: ... }}` (CSS @keyframes already deleted in Task 1)

    This restores the exact code from git commit 8dcda22 (the original extraction). The component is imported by `components/page-content.tsx` which is already a "use client" file, so this is a proper client boundary.

  </action>
  <verify>
    - `head -1 components/marquee-text.tsx` shows `"use client";`
    - `grep "framer-motion" components/marquee-text.tsx` returns a match
    - `grep "motion.div" components/marquee-text.tsx` returns a match
    - `grep "marquee-scroll" components/marquee-text.tsx` returns NO match (no CSS animation reference)
    - `npx next build` completes without errors (or `npx tsc --noEmit` for type checking)
  </verify>
  <done>MarqueeText uses framer-motion with "use client" directive. Smooth infinite scroll animation restored via motion.div animate/transition props. No references to deleted CSS @keyframes.</done>
</task>

</tasks>

<verification>
1. Build check: `npx next build` succeeds with no errors (no broken imports to deleted files)
2. No orphaned references: `grep -r "css-preloader\|CSSPreloader\|graph-legend\|GraphLegend\|loading\.tsx" --include="*.tsx" --include="*.ts" .` returns no matches (except this plan file)
3. MarqueeText wiring: `grep "MarqueeText" components/page-content.tsx` still shows two import/usage sites
4. CSS clean: `grep "@keyframes" app/globals.css` shows only "twinkle"
</verification>

<success_criteria>

- Three obsolete files deleted (app/loading.tsx, components/css-preloader.tsx, components/graph-legend.tsx)
- globals.css contains exactly one @keyframes block (twinkle) with zero orphaned animation definitions
- MarqueeText uses framer-motion with "use client", producing smooth continuous horizontal scroll
- `npx next build` succeeds with no import errors
  </success_criteria>

<output>
After completion, create `.planning/phases/10-client-boundary-extraction/10-03-SUMMARY.md`
</output>
